<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>점프 투 장고 공부 5 | 주경야독학) 개발공부로그</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="점프 투 장고 공부 5" />
<meta name="author" content="Sunmi Moon" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="3장 파이보 서비스 개발!" />
<meta property="og:description" content="3장 파이보 서비스 개발!" />
<link rel="canonical" href="http://localhost:4000/2022-08-21/jump-to-django-5" />
<meta property="og:url" content="http://localhost:4000/2022-08-21/jump-to-django-5" />
<meta property="og:site_name" content="주경야독학) 개발공부로그" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-08-21T22:39:25+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="점프 투 장고 공부 5" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Sunmi Moon","url":"https://moonsunmi.github.io"},"dateModified":"2022-08-21T22:39:25+09:00","datePublished":"2022-08-21T22:39:25+09:00","description":"3장 파이보 서비스 개발!","headline":"점프 투 장고 공부 5","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2022-08-21/jump-to-django-5"},"url":"http://localhost:4000/2022-08-21/jump-to-django-5"}</script>
<!-- End Jekyll SEO tag -->


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">

  <!-- RSS -->
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="주경야독학) 개발공부로그" />

  <!-- Google Analytics-->
  
</head>


  <body>
    <nav class="nav">
  <div class="nav-container">
    <a href="/">
      <h2 class="nav-title">주경야독학) 개발공부로그</h2>
    </a>
    <ul>
      <li><a href="/">Posts</a></li>
      <li><a href="/tags">Tags</a></li>
      <li><a href="/about">About</a></li>
    </ul>
  </div>
</nav>


    <main><div class="post">
  <h1 class="post-title">점프 투 장고 공부 5</h1>

  <div class="post-info">
    
    <br />
    <span>on&nbsp;</span
    ><time datetime="2022-08-21 22:39:25 +0900">August 21, 2022</time>
    
  </div>

  <h2 id="3장-파이보-서비스-개발">3장 파이보 서비스 개발!</h2>

<h3 id="3-01-내비게이션바">3-01 내비게이션바</h3>

<p>navbar.html</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- 내비게이션바 start --&gt;</span>
<span class="nt">&lt;nav</span> <span class="na">class=</span><span class="s">"navbar navbar-expand-lg navbar-light bg-light"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container-fluid"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"navbar-brand"</span> <span class="na">href=</span><span class="s">"{% url 'pybo:index' %}"</span><span class="nt">&gt;</span>Pybo<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;button</span>
      <span class="na">class=</span><span class="s">"navbar-toggler"</span>
      <span class="na">type=</span><span class="s">"button"</span>
      <span class="na">data-bs-toggle=</span><span class="s">"collapse"</span>
      <span class="na">data-bs-target=</span><span class="s">"#navbarSupportedContent"</span>
      <span class="na">aria-controls=</span><span class="s">"navbarSupportedContent"</span>
      <span class="na">aria-expanded=</span><span class="s">"false"</span>
      <span class="na">aria-label=</span><span class="s">"Toggle navigation"</span>
    <span class="nt">&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"navbar-toggler-icon"</span><span class="nt">&gt;&lt;/span&gt;</span>
    <span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"collapse navbar-collapse"</span> <span class="na">id=</span><span class="s">"navbarSupportedContent"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"navbar-nav me-auto mb-2 mb-lg-0"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"nav-item"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"nav-link"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>로그인<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
      <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/nav&gt;</span>

<span class="c">&lt;!-- 내비게이션바 end --&gt;</span>
</code></pre></div></div>

<p>navbar.html 파일은 다른 템플릿들에서 중복되어 사용되지는 않지만 독립된 하나의 템플릿으로 관리하는 것이 유지 보수에 유리하므로 분리하였다.</p>

<p>views.py</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.core.paginator</span> <span class="kn">import</span> <span class="n">Paginator</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Question</span>
<span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="n">QuestionForm</span><span class="p">,</span> <span class="n">AnswerForm</span>


<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">GET</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'page'</span><span class="p">,</span> <span class="s">'1'</span><span class="p">)</span>
    <span class="n">question_list</span> <span class="o">=</span> <span class="n">Question</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">'-create_date'</span><span class="p">)</span>
    <span class="n">paginator</span> <span class="o">=</span> <span class="n">Paginator</span><span class="p">(</span><span class="n">question_list</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">page_obj</span> <span class="o">=</span> <span class="n">paginator</span><span class="p">.</span><span class="n">get_page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s">'question_list'</span><span class="p">:</span> <span class="n">page_obj</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'pybo/question_list.html'</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">page = request.GET.get('page', '1')</code>은 http://localhost:8000/pybo/?page=1 처럼 GET 방식으로 호출된 URL에서 page값을 가져올 때 사용한다.</p>

<p><code class="language-plaintext highlighter-rouge">page_obj = paginator.get_page(page)</code>
<code class="language-plaintext highlighter-rouge">paginator</code>를 이용하여 요청된 페이지(page)에 해당되는 페이징 객체(<code class="language-plaintext highlighter-rouge">page_obj</code>)를 생성했다. 이렇게 하면 장고 내부적으로는 데이터 전체를 조회하지 않고 해당 페이지의 데이터만 조회하도록 쿼리가 변경된다.</p>

<blockquote>
  <p>HTML5</p>

  <ul>
    <li><code class="language-plaintext highlighter-rouge">&lt;ul&gt;</code> 순서 없는 목록(Unordered List)이란 나열된 항목들 간의 구분이 없는 목록을 뜻합니다.</li>
    <li><code class="language-plaintext highlighter-rouge">&lt;ol&gt;</code> 순서 있는 목록(Ordered List)이란 기호를 이용해서 각 항목들 사이의 순서를 구분하는 목록을 뜻합니다.</li>
  </ul>
</blockquote>

<p>페이징 작업</p>

<p>question_list.html</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c">&lt;!-- 페이징 시작 --&gt;</span>

        <span class="c">&lt;!-- 페이지 리스트 시작 --&gt;</span>
        {% for page_number in question_list.paginator.page_range %}
        {% if page_number &gt;= question_list.number|add:-5 and page_number <span class="nt">&lt;</span><span class="err">=</span> <span class="na">question_list</span><span class="err">|</span><span class="na">add:5</span> <span class="err">%}&lt;!</span><span class="na">--</span> <span class="na">현재</span> <span class="na">페이지</span> <span class="na">기준으로</span> <span class="na">좌우</span> <span class="err">5</span><span class="na">개씩</span> <span class="na">보이도록</span> <span class="na">만든다.</span> <span class="na">--</span><span class="nt">&gt;</span>
        {% if page_number == question_list.number %}
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"page-item active"</span> <span class="na">aria-current=</span><span class="s">"page"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"page-link"</span> <span class="na">href=</span><span class="s">"?page={{ page_number }}"</span><span class="nt">&gt;</span>{{ page_number }}<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
        {% else %}
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"page-item"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"page-link"</span> <span class="na">href=</span><span class="s">"?page={{ page_number }}"</span><span class="nt">&gt;</span>{{ page_number }}<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
        {% endif %}
        {% endif %}
        {% endfor %}
        <span class="c">&lt;!-- 페이지 리스트 끝 --&gt;</span>
        <span class="c">&lt;!-- 다음 페이지 시작 --&gt;</span>
        {% if question_list.has_next %}
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"page-item"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"page-link"</span> <span class="na">href=</span><span class="s">"?page={{ page_number }}"</span><span class="nt">&gt;</span>다음<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
        {% else %}
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"page-item disabled"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"page-link"</span> <span class="na">tabindex=</span><span class="s">"-1"</span> <span class="na">aria-disabled=</span><span class="s">"true"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>다음<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
        {% endif %}
        <span class="c">&lt;!-- 다음 페이지 끝 --&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
    <span class="c">&lt;!-- 페이징 끝 --&gt;</span>
</code></pre></div></div>

<h3 id="3-03-템플릿-필터">3-03 템플릿 필터</h3>

<p>페이지별로 게시물의 번호를 역순으로 정렬하려면 다음과 같은 공식을 적용해야 한다.</p>

<ul>
  <li>번호 = 전체건수 - 시작인덱스 - 현재인덱스 + 1</li>
</ul>

<p>장고에는 빼기 필터가 없으므로 직접 만든다. <code class="language-plaintext highlighter-rouge">@register.filter</code> 애너테이션을 적용하면 템플릿에서 해당 함수를 필터로 사용할 수 있다.</p>

<p>pybo_filter.py</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">template</span>

<span class="n">register</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">Library</span><span class="p">()</span>


<span class="o">@</span><span class="n">register</span><span class="p">.</span><span class="nb">filter</span>
<span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">value</span> <span class="o">-</span> <span class="n">arg</span>
</code></pre></div></div>

<p>글 번호 순서대로 잘 나오게 하기</p>

<p>question_list.html</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% if question_list %} {% for question in question_list %}
<span class="nt">&lt;tr&gt;</span>
  <span class="nt">&lt;td&gt;</span>
    <span class="c">&lt;!-- 번호 = 전체건수 - 시작인덱스 - 현재인덱스 + 1 --&gt;</span>
    {{
    question_list.paginator.count|sub:question_list.start_index|sub:forloop.counter0|add:1
    }}
  <span class="nt">&lt;/td&gt;</span>
  <span class="nt">&lt;td&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"{% url 'pybo:detail' question.id %}"</span><span class="nt">&gt;</span>{{ question.subject }}<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/td&gt;</span>
  <span class="nt">&lt;td&gt;</span>{{ question.author }}<span class="nt">&lt;/td&gt;</span>
  <span class="nt">&lt;td&gt;</span>{{ question.create_date }}<span class="nt">&lt;/td&gt;</span>
<span class="nt">&lt;/tr&gt;</span>
{% endfor %} {% else %}
<span class="nt">&lt;tr&gt;</span>
  <span class="nt">&lt;td</span> <span class="na">colspan=</span><span class="s">"3"</span><span class="nt">&gt;</span>질문이 없습니다.<span class="nt">&lt;/td&gt;</span>
<span class="nt">&lt;/tr&gt;</span>
{% endif %}
</code></pre></div></div>

<blockquote>
  <p>django 코드 github.io 블로그 글 업로드 에러</p>

  <ul>
    <li>django 코드가 포함된 블로그 글이 업로드되지 않았다. 지킬 태그로 인식하여 오류가 나는 것이었다. 이를 방지하려면 raw와 endraw로 코드를 감싸면 된다.</li>
  </ul>
</blockquote>

</div>



<div class="pagination">
  
  <a href="/2022-08-22/jump-to-django-6" class="left arrow"
    >&#8592;</a
  >
   
  <a href="/2022-08-20/jump-to-django-4" class="right arrow"
    >&#8594;</a
  >
  

  <a href="#" class="top">Top</a>
</div>
</main>

    <footer>
  <span>
    &copy; <time datetime="2023-09-20 20:43:43 +0900">2023</time> Sunmi Moon. Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
  </span>
</footer>

  </body>
</html>
