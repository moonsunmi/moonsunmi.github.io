<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Hulu Clone Coding(Next.js, Tailwind CSS, Responsive) | 주경야독학) 개발공부로그</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Hulu Clone Coding(Next.js, Tailwind CSS, Responsive)" />
<meta name="author" content="Sunmi Moon" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Nav에 query 연결하기" />
<meta property="og:description" content="Nav에 query 연결하기" />
<link rel="canonical" href="http://localhost:4000/2022-10-24/TIL" />
<meta property="og:url" content="http://localhost:4000/2022-10-24/TIL" />
<meta property="og:site_name" content="주경야독학) 개발공부로그" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-10-24T12:18:07+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Hulu Clone Coding(Next.js, Tailwind CSS, Responsive)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Sunmi Moon","url":"https://moonsunmi.github.io"},"dateModified":"2022-10-24T12:18:07+09:00","datePublished":"2022-10-24T12:18:07+09:00","description":"Nav에 query 연결하기","headline":"Hulu Clone Coding(Next.js, Tailwind CSS, Responsive)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2022-10-24/TIL"},"url":"http://localhost:4000/2022-10-24/TIL"}</script>
<!-- End Jekyll SEO tag -->


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">

  <!-- RSS -->
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="주경야독학) 개발공부로그" />

  <!-- Google Analytics-->
  
</head>


  <body>
    <nav class="nav">
  <div class="nav-container">
    <a href="/">
      <h2 class="nav-title">주경야독학) 개발공부로그</h2>
    </a>
    <ul>
      <li><a href="/">Posts</a></li>
      <li><a href="/tags">Tags</a></li>
      <li><a href="/about">About</a></li>
    </ul>
  </div>
</nav>


    <main><div class="post">
  <h1 class="post-title">Hulu Clone Coding(Next.js, Tailwind CSS, Responsive)</h1>

  <div class="post-info">
    
    <br />
    <span>on&nbsp;</span
    ><time datetime="2022-10-24 12:18:07 +0900">October 24, 2022</time>
    
  </div>

  <h3 id="nav에-query-연결하기">Nav에 query 연결하기</h3>

<p><code class="language-plaintext highlighter-rouge">useRouter</code> next의 hook을 사용한다.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">useRouter</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">next/router</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">requests</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../utils/requests</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">Nav</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">useRouter</span><span class="p">();</span>

            <span class="o">&lt;</span><span class="nx">h2</span>
            <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">key</span><span class="p">}</span>
            <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="nx">router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">`/?genre=</span><span class="p">${</span><span class="nx">key</span><span class="p">}</span><span class="s2">`</span><span class="p">)}</span>
</code></pre></div></div>

<h3 id="nav의-스크롤바-없애기">Nav의 스크롤바 없애기</h3>

<p>tailwind-scrollbar-hide 플러그인을 설치한다.</p>

<p>https://github.com/reslear/tailwind-scrollbar-hide</p>

<p>tailwind.conig.js에 다음과 같이 플러그인을 추가해 주고,</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">plugins</span><span class="p">:</span> <span class="p">[</span>
  <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">tailwind-scrollbar-hide</span><span class="dl">"</span><span class="p">),</span>
  <span class="c1">// ...</span>
<span class="p">];</span>
</code></pre></div></div>

<p>원하는 위치에서 <code class="language-plaintext highlighter-rouge">scrollbar-hide</code>를 지정해 주기만 하면 된다.</p>

<h3 id="tmdb에서-api-key-가져-오기">tmdb에서 API Key 가져 오기</h3>

<p>회원 가입 후 API Key를 생성한다. 그다음 ‘env.local’ 파일을 만들고 다음과 같이 적어 둔다.</p>

<p>env.local</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>API_KEY=thisismyprivatekey
</code></pre></div></div>

<p>(내 API_KEY로 입력함)</p>

<h3 id="nextjs">Next.js</h3>

<p>SSR(Server Side Rendering)을 해준다. javascript를 서버상에서 돌리고 나서, 결과를 prop을 통해 유저에게 전달한다.</p>

<p>getServerSideProps 함수에서 server side rendering된 후에 <code class="language-plaintext highlighter-rouge">Home</code> 컴포넌트에 프러퍼티로 값을 전달해 준다.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Head</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">next/head</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Header</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../components/Header</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Nav</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../components/Nav</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Results</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../components/Results</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">requests</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../utils/requests</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// client rendered</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">Home</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">Head</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">title</span><span class="o">&gt;</span><span class="nx">Hulu</span> <span class="mf">2.0</span><span class="o">&lt;</span><span class="sr">/title</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="dl">"</span><span class="s2">icon</span><span class="dl">"</span> <span class="nx">href</span><span class="o">=</span><span class="dl">"</span><span class="s2">/favicon.ico</span><span class="dl">"</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="sr">/Head</span><span class="err">&gt;
</span>
      <span class="o">&lt;</span><span class="nx">Header</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nx">Nav</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nx">Results</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>

<span class="c1">// server rendered</span>
<span class="k">export</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">getServerSideProps</span><span class="p">(</span><span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">genre</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">genre</span><span class="p">;</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">genre</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span>
    <span class="s2">`https://api.themoviedb.org/3</span><span class="p">${</span>
      <span class="nx">requests</span><span class="p">[</span><span class="nx">genre</span><span class="p">]?.</span><span class="nx">url</span> <span class="o">||</span> <span class="nx">requests</span><span class="p">.</span><span class="nx">fetchTrending</span><span class="p">.</span><span class="nx">url</span>
    <span class="p">}</span><span class="s2">`</span>
  <span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">results</span><span class="p">:</span> <span class="nx">request</span><span class="p">.</span><span class="nx">results</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>
    <p>async function이므로 fetch 시 await를 해야 한다.</p>
  </li>
  <li>
    <p>context: 중요한 디테일을 가지고 있다. 유저가 들어온 url이 뭔지 같은. 여기에서 url을 알아야 한다. 그래야 영화 장르를 알아낼 수 있고 하니깐.</p>
  </li>
  <li>
    <p>HeaderItem 엘리먼트를 클릭했을 때 장르를 query로 작업했다.</p>
  </li>
</ul>

<p>그런데 다음과 같은 에러가 났다. 직렬화에서 오류가 났다는데.. google에서 다른 사람의 케이스를 검색해 봤는데, 내 경우와 같지는 않은 것 같았다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>error - SerializableError: Error serializing `.results` returned from `getServerSideProps` in "/".
Reason: `undefined` cannot be serialized as JSON. Please use `null` or omit this value.
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">results</code>의 직렬화에서 오류가 났다고 나오지만, <code class="language-plaintext highlighter-rouge">genre</code> 값부터 <code class="language-plaintext highlighter-rouge">undefined</code>였다. 거슬러 가 보니 API_KEY를 제대로 가져오지 못하고 있었다.</p>

<p><code class="language-plaintext highlighter-rouge">'/trending/all/week?api_key=undefined&amp;language=en-US'</code></p>

<p>파일을 ‘.env.local’로 만들어야 하는데, ‘env.local’로 만들어서 난 오류였다.</p>

<hr />

<p>visual studio code 단축키
ctrl + t: 파일 이름 찾기</p>

<hr />

<p>월) 운동</p>

<table>
  <thead>
    <tr>
      <th>의자스쿼트</th>
      <th>종아리운동</th>
      <th>삼두</th>
      <th>뒷벅지</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>3/3</td>
      <td>3/3</td>
      <td>3/3</td>
      <td>3/3</td>
    </tr>
  </tbody>
</table>

</div>



<div class="pagination">
  
  <a href="/2022-10-25/TIL" class="left arrow"
    >&#8592;</a
  >
   
  <a href="/2022-10-23/13th-week" class="right arrow"
    >&#8594;</a
  >
  

  <a href="#" class="top">Top</a>
</div>
</main>

    <footer>
  <span>
    &copy; <time datetime="2023-09-20 20:43:43 +0900">2023</time> Sunmi Moon. Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
  </span>
</footer>

  </body>
</html>
