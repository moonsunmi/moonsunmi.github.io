<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>연오의 파이썬 공부 15 | 주경야독학) 개발공부로그</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="연오의 파이썬 공부 15" />
<meta name="author" content="Sunmi Moon" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="현재 시간 측정 후 해석 import time now = time.gmtime(time.time()) 시간 단위 다룰 때 많이 쓰는 datetime 모듈 from datetime import time time(15, 30, 45) # 15시 30분 45초 from datetime import datetime datetime(2020, 11, 14, 8, 30) # 2020년 11월 14일 8시 30분 now.isoformat() &#39;2022-08-07T06:44:30.304039&#39; 날짜와 시간을 T로 구별. now.isoformat((sep=&#39; &#39;))와 같이 매개변수로 지정할 수 있다. strftime() 메서드는 양식 문자열을 전달받아 시간 정보 객체를 양식화한다. 코드 11-45 from datetime import timedelta timedelta(days=5) datetime.timedelta(days=5) timedelta(weeks=5) datetime.timedelta(days=35) 연습문제 11-3 -&gt; 논리 오류: 윤년을 생각 못하고, 1년 365일로 계산하였음. from datetime import date class BirthdayException(Exception): &quot;&quot;&quot;생일 오류&quot;&quot;&quot; pass def counting_age(birth_date): &quot;&quot;&quot;생년월일(birth_date)을 입력받아 세는 나이를 반환한다.&quot;&quot;&quot; # 세는 나이는 year 계산 year_gap = date.today().year - birth_date.year if year_gap &lt; 0: raise BirthdayException(&#39;미래에 태어날 사람의 나이는 계산할 수 없습니다.&#39;) return year_gap + 1 def full_age(birth_date): &quot;&quot;&quot;생년월일(birth_date)을 입력받아 만 나이를 반환한다.&quot;&quot;&quot; # 만 나이는 day 계산 day_gap = date.today() - birth_date if day_gap.days &lt; 0: raise BirthdayException(&#39;미래에 태어날 사람의 나이는 계산할 수 없습니다.&#39;) return day_gap.days // 365 def test_full_age(): assert full_age(date(2022, 8, 7)) == 0 assert full_age(date(2020, 1, 1)) == 2 assert full_age(date(2020, 12, 31)) == 1 def test_counting_age(): assert counting_age(date(2022, 8, 7)) == 1 assert counting_age(date(2020, 1, 1)) == 3 assert counting_age(date(2020, 12, 31)) == 3 test_full_age() test_counting_age() try: print(&#39;만 나이: &#39;, full_age(date(1985, 7, 16))) except Exception as error: print(error) try: print(&#39;세는 나이: &#39;, counting_age(date(1985, 7, 16))) except Exception as error: print(error) try: print(&#39;만 나이: &#39;, full_age(date(2985, 7, 16))) except Exception as error: print(error) try: print(&#39;세는 나이: &#39;, counting_age(date(2985, 7, 16))) except Exception as error: print(error) 연습문제 11-3 update # 논리 오류: 윤년을 생각 못하고, 1년을 365일로 고정하여 계산함. from datetime import date, timedelta class BirthdayException(Exception): &quot;&quot;&quot;생일 오류&quot;&quot;&quot; pass def counting_age(birth_date): &quot;&quot;&quot;생년월일(birth_date)을 입력받아 세는 나이를 반환한다.&quot;&quot;&quot; # 세는 나이는 year 계산 year_gap = date.today().year - birth_date.year if year_gap &lt; 0: raise BirthdayException(&#39;미래에 태어날 사람의 나이는 계산할 수 없습니다.&#39;) return year_gap + 1 def full_age(birth_date): &quot;&quot;&quot;생년월일(birth_date)을 입력받아 만 나이를 반환한다.&quot;&quot;&quot; # 만 나이는 day 계산 day_gap = date.today() - birth_date if day_gap.days &lt; 0: raise BirthdayException(&#39;미래에 태어날 사람의 나이는 계산할 수 없습니다.&#39;) is_after_birthday = timedelta(0) &lt;= date.today() - date(date.today().year, birth_date.month, birth_date.day) return date.today().year - birth_date.year + (0 if is_after_birthday else -1) def test_full_age(): assert full_age(date(1999, 1, 1)) == 23 assert full_age(date(1999, 8, 8)) == 22 assert full_age(date(2000, 1, 1)) == 22 assert full_age(date(2000, 8, 8)) == 21 assert full_age(date(2020, 1, 1)) == 2 assert full_age(date(2020, 12, 31)) == 1 assert full_age(date(2022, 8, 7)) == 0 def test_counting_age(): assert counting_age(date(2022, 8, 7)) == 1 assert counting_age(date(2020, 1, 1)) == 3 assert counting_age(date(2020, 12, 31)) == 3 assert counting_age(date(1999, 1, 1)) == 24 assert counting_age(date(1999, 8, 8)) == 24 assert counting_age(date(2000, 1, 1)) == 23 assert counting_age(date(2000, 8, 8)) == 23 test_full_age() test_counting_age() try: print(&#39;만 나이: &#39;, full_age(date(1985, 7, 16))) except Exception as error: print(error) try: print(&#39;세는 나이: &#39;, counting_age(date(1985, 7, 16))) except Exception as error: print(error) try: print(&#39;만 나이: &#39;, full_age(date(2985, 7, 16))) except Exception as error: print(error) try: print(&#39;세는 나이: &#39;, counting_age(date(2985, 7, 16))) except Exception as error: print(error) 리스트·사전 등 컬렉션을 중첩한 입체적인 데이터를 파일로 저장하고 읽어 들이기 위해 약속에 따라 입체적인 데이터를 텍스트나 바이트로 표현하는 것을 직렬화(serialization)라고 한다. 코드 11-50 print(&#39;당신의 이름은 무엇인가요?&#39;) name = input() with open(&#39;hello.txt&#39;, &#39;w&#39;) as file: print(name, &#39;님 반가워요.&#39;, file=file) 코드 11-51 from datetime import date today = date.today() text = f&#39;안녕하세요! 오늘은 {today.month}월 {today.day}일입니다.\n&#39; with open(&#39;hello.txt&#39;, &#39;w&#39;) as file: file.write(text) 코드 11-52 from datetime import datetime now = datetime.now() text = f&#39;현재 시각: {now.hour:02}:{now.minute:02}:{now.second:02}\n&#39; with open(&#39;time.txt&#39;, &#39;a&#39;) as file: file.write(text) 코드 11-53 try: with open(&#39;once.text&#39;, &#39;x&#39;) as file: file.write(&#39;이 파일은 한 번만 작성됩니다.&#39;) except FileExistsError: print(&#39;파일이 이미 존재합니다.&#39;) 코드 11-54 with open(&#39;time.txt&#39;, &#39;r&#39;) as file: date = file.read() print(date) 코드 11-55 with open(&#39;time.txt&#39;, &#39;r&#39;) as file: for line in file: print(line, end=&#39;&#39;) 코드 11-56 import csv import pprint with open(&#39;movies.csv&#39;) as file: reader = csv.reader(file) movies = list(reader) pprint.pprint(movies) 코드 11-57 import csv table = [ [&#39;title&#39;, &#39;genre&#39;, &#39;year&#39;], [&#39;Interstellar&#39;, &#39;SF&#39;, &#39;2014&#39;], [&#39;Braveheart&#39;, &#39;Drama&#39;, &#39;1995&#39;], [&#39;Mary Poppins&#39;, &#39;Fantasy&#39;, &#39;1964&#39;], [&#39;Gloomy Sunday&#39;, &#39;Drama&#39;, &#39;2000&#39;], ] with open(&#39;movies_output.csv&#39;, &#39;w&#39;, newline=&#39;&#39;) as file: writer = csv.writer(file) writer.writerows(table) 코드 11-58 import json data = [ { &#39;title&#39;: &#39;Interstellar&#39;, &#39;genre&#39;: &#39;SF&#39;, &#39;year&#39;: 2014, &#39;starring&#39;: [&#39;M. McConaughey&#39;, &#39;A. Hathaway&#39;, &#39;J. Chastain&#39;], }, { &#39;title&#39;: &#39;Mary Poppins&#39;, &#39;genre&#39;: &#39;Fantasy&#39;, &#39;year&#39;: 1964, &#39;starring&#39;: [&#39;J. Andrews&#39;, &#39;D. Van Dyke&#39;], } ] json_data = json.dumps(data) print(json_data) with open(&#39;movies.json&#39;, &#39;w&#39;) as file: file.write(json_data) 코드 11-59 import json import pprint with open(&#39;movies.json&#39;) as file: json_data = file.read() data = json.loads(json_data) pprint.pprint(data) 코드 11-62 from pathlib import Path def ls(path): path_obj = Path(path) for item in path_obj.iterdir(): print(item) print(ls(&#39;/Users&#39;)) # macOS라서 다르게 실습 코드 11-63 from pathlib import Path path = Path(&#39;/Users&#39;) path_list = list(path.iterdir()) print(path_list) print(path_list[0]) print(path_list[0].is_dir()) 코드 11-65 from pathlib import Path path = Path(&#39;/Users&#39;) path_list = list(path.iterdir()) Path(&#39;dir1&#39;).mkdir() Path(&#39;dir2&#39;).mkdir() Path(&#39;file1&#39;).touch() Path(&#39;dir2&#39;).replace(&#39;dir1/dir2&#39;) Path(&#39;dir1/dir2&#39;).replace(Path(&#39;dir2&#39;)) Path(&#39;dir2&#39;).replace(&#39;dir3&#39;) 코드 11-66 from pathlib import Path def mv(src, dst): &quot;&quot;&quot;src 경로의 파일을 dst 경로로 이동한다.&quot;&quot;&quot; src_obj = Path(src) dst_obj = Path(dst) if dst_obj.exists(): raise FileExistsError src_obj.replace(dst_obj) mv(&#39;dir2&#39;, &#39;dir88&#39;) 연습문제 11-4 from pathlib import Path def cp(src, dst): src_obj = Path(src) dst_obj = Path(dst) if not src_obj.exists(): raise FileNotFoundError with open(src_obj, &#39;r&#39;) as file: all_text = file.read() with open(dst_obj, &#39;w&#39;) as file: file.write(all_text) cp(&#39;original.txt&#39;, &#39;clone.txt&#39;) 연습문제 11-4 모범답안처럼 업데이트 def cp(src, dst): with open(src, &#39;r&#39;) as read_file, open(dst, &#39;w&#39;) as write_file: write_file.write(read_file.read()) cp(&#39;original.txt&#39;, &#39;clone.txt&#39;) 연습문제 11-5 import csv # 인구 밀도가 높은 나라부터 낮은 나라 순으로 나라 이름과 인구 밀도를 출력하라. def population_density(population, area): &quot;&quot;&quot;인구 밀도를 구한다.&quot;&quot;&quot; return population / area with open(&#39;population.csv&#39;, &#39;r&#39;) as file: reader = csv.reader(file) countries = list(reader)[1:] country_density = [] for country in countries: country_density.append([country[0], population_density(int(country[1]), int(country[2]))]) sorted_country_density = sorted(country_density, key=lambda country_density: country_density[1], reverse=True) for density in sorted_country_density: print(density[0], density[1]) 연습문제 11-5 모범답안처럼 업데이트 import csv # 인구 밀도가 높은 나라부터 낮은 나라 순으로 나라 이름과 인구 밀도를 출력하라. def population_density(population, area): &quot;&quot;&quot;인구 밀도를 구한다.&quot;&quot;&quot; return population / area with open(&#39;population.csv&#39;, &#39;r&#39;) as file: reader = csv.reader(file) countries = list(reader)[1:] for country in countries: country.append(population_density(int(country[1]), int(country[2]))) sorted_country = sorted(countries, key=lambda row: row[3], reverse=True) for density in sorted_country: print(density[0], density[3]) 부록 A HTTP 통신의 과정 웹브라우저가 en.wikipedia.org 호스트에 /wiki/Python_(programming_language)라는 자원을 요청하는 HTTP 요청 메시지를 발송한다. en.wikipedia.org 호스트가 클라이언트에 HTTP 응답 메시지를 발송한다. 웹브라우저가 응답 메시지를 해석하여 화면에 웹 문서를 출력한다. 파이썬은 URL과 웹 요청에 관련된 모듈들을 urllib 패키지도 묶어 제공한다. urllib.request.urlopen(요청할URL): 응답객체(HTTPResponse)를 반환한다. urllib.request.urlopen(요청할URL).read(): 웹서버가 응답한 데이터를 바이트 배열로 읽어 들임 urllib.request.urlopen(요청할URL).read().decode(&#39;utf-8&#39;): 바이트 배열을 문자열로 변환 HTTPS는 HTTP에 SSL이라는 암·복호화 단계를 적용하여 보안 통신을 수행하는 프로토콜 코드 11-68 import urllib.request def request(url): &quot;&quot;&quot;지정한 url의 웹 문서를 요청하여, 본문을 반환한다.&quot;&quot;&quot; response = urllib.request.urlopen(url) byte_date = response.read() text_data = byte_date.decode(&#39;utf-8&#39;) return text_data 코드 11-69 import urllib.request url = &#39;https://python.bakyeono.net&#39; webpage = urllib.request.urlopen(url).read().decode(&#39;utf-8&#39;) print(webpage) 코드 11-70 import urllib.request url = &#39;https://python.bakyeono.net/data/movies.json&#39; text_data = urllib.request.urlopen(url).read().decode(&#39;-utf-8&#39;) print(text_data) 코드 11-71 import urllib.request import json url = &#39;https://python.bakyeono.net/data/movies.json&#39; text_data = urllib.request.urlopen(url).read().decode(&#39;-utf-8&#39;) movies = json.loads(text_data) sorted_by_year = sorted(movies, key=lambda movie: movie[&#39;year&#39;]) for movie in sorted_by_year: print(str(movie[&#39;year&#39;]) + &#39; &#39; + movie[&#39;title&#39;].upper()) 코드 11-72 import urllib.parse url = &#39;https://python.bakyeono.net/data/movies.json&#39; url_parts = urllib.parse.urlsplit(url) print(url_parts[0]) print(url_parts[1]) print(url_parts[2]) 코드 11-73 import urllib.parse url = &#39;https://python.bakyeono.net/data/movies.json&#39; url_parts = urllib.parse.urlsplit(url) url_parts = list(url_parts) url_parts[2] = &#39;/chapter-11.html&#39; print(urllib.parse.urlunsplit(url_parts)) URL에는 영문자, 숫자, 몇몇 기호들만 사용할 수 있다. 아스키 코드가 아닌 문자들을 퍼센트 인코딩 형식으로 바꾸어야 한다. http.server 모듈로 간단한 웹 서버를 만들 수 있다. 코드 11-78 import http.server class HTTPRequestHandler(http.server.BaseHTTPRequestHandler): def do_GET(self): &quot;&quot;&quot;HTTP GET 요청을 처리한다.&quot;&quot;&quot; self.route() def route(self): &quot;&quot;&quot;요청 URL의 path에 따라 요청을 처리할 함수를 중계한다.&quot;&quot;&quot; if self.path == &#39;/hello&#39;: self.hello() else: self.response_404_not_found() def hello(self): &quot;&quot;&quot;200 OK 상태 코드와 인사말을 응답한다.&quot;&quot;&quot; self.response(200, &#39;안녕하세요?&#39;) def response(self, status_code, body): &quot;&quot;&quot;응답 메시지를 전송한다.&quot;&quot;&quot; self.send_response(status_code) self.send_header(&#39;Content-type&#39;, &#39;text/plain; charset=utf-8&#39;) self.end_headers() self.wfile.write(body.encode(&#39;utf-8&#39;)) ADDRESS = &#39;localhost&#39;, 8000 listener = http.server.HTTPServer(ADDRESS, HTTPRequestHandler) print(f&#39;http://{ADDRESS[0]}:{ADDRESS[1]} 주소에서 요청 대기중...&#39;) listener.serve_forever()" />
<meta property="og:description" content="현재 시간 측정 후 해석 import time now = time.gmtime(time.time()) 시간 단위 다룰 때 많이 쓰는 datetime 모듈 from datetime import time time(15, 30, 45) # 15시 30분 45초 from datetime import datetime datetime(2020, 11, 14, 8, 30) # 2020년 11월 14일 8시 30분 now.isoformat() &#39;2022-08-07T06:44:30.304039&#39; 날짜와 시간을 T로 구별. now.isoformat((sep=&#39; &#39;))와 같이 매개변수로 지정할 수 있다. strftime() 메서드는 양식 문자열을 전달받아 시간 정보 객체를 양식화한다. 코드 11-45 from datetime import timedelta timedelta(days=5) datetime.timedelta(days=5) timedelta(weeks=5) datetime.timedelta(days=35) 연습문제 11-3 -&gt; 논리 오류: 윤년을 생각 못하고, 1년 365일로 계산하였음. from datetime import date class BirthdayException(Exception): &quot;&quot;&quot;생일 오류&quot;&quot;&quot; pass def counting_age(birth_date): &quot;&quot;&quot;생년월일(birth_date)을 입력받아 세는 나이를 반환한다.&quot;&quot;&quot; # 세는 나이는 year 계산 year_gap = date.today().year - birth_date.year if year_gap &lt; 0: raise BirthdayException(&#39;미래에 태어날 사람의 나이는 계산할 수 없습니다.&#39;) return year_gap + 1 def full_age(birth_date): &quot;&quot;&quot;생년월일(birth_date)을 입력받아 만 나이를 반환한다.&quot;&quot;&quot; # 만 나이는 day 계산 day_gap = date.today() - birth_date if day_gap.days &lt; 0: raise BirthdayException(&#39;미래에 태어날 사람의 나이는 계산할 수 없습니다.&#39;) return day_gap.days // 365 def test_full_age(): assert full_age(date(2022, 8, 7)) == 0 assert full_age(date(2020, 1, 1)) == 2 assert full_age(date(2020, 12, 31)) == 1 def test_counting_age(): assert counting_age(date(2022, 8, 7)) == 1 assert counting_age(date(2020, 1, 1)) == 3 assert counting_age(date(2020, 12, 31)) == 3 test_full_age() test_counting_age() try: print(&#39;만 나이: &#39;, full_age(date(1985, 7, 16))) except Exception as error: print(error) try: print(&#39;세는 나이: &#39;, counting_age(date(1985, 7, 16))) except Exception as error: print(error) try: print(&#39;만 나이: &#39;, full_age(date(2985, 7, 16))) except Exception as error: print(error) try: print(&#39;세는 나이: &#39;, counting_age(date(2985, 7, 16))) except Exception as error: print(error) 연습문제 11-3 update # 논리 오류: 윤년을 생각 못하고, 1년을 365일로 고정하여 계산함. from datetime import date, timedelta class BirthdayException(Exception): &quot;&quot;&quot;생일 오류&quot;&quot;&quot; pass def counting_age(birth_date): &quot;&quot;&quot;생년월일(birth_date)을 입력받아 세는 나이를 반환한다.&quot;&quot;&quot; # 세는 나이는 year 계산 year_gap = date.today().year - birth_date.year if year_gap &lt; 0: raise BirthdayException(&#39;미래에 태어날 사람의 나이는 계산할 수 없습니다.&#39;) return year_gap + 1 def full_age(birth_date): &quot;&quot;&quot;생년월일(birth_date)을 입력받아 만 나이를 반환한다.&quot;&quot;&quot; # 만 나이는 day 계산 day_gap = date.today() - birth_date if day_gap.days &lt; 0: raise BirthdayException(&#39;미래에 태어날 사람의 나이는 계산할 수 없습니다.&#39;) is_after_birthday = timedelta(0) &lt;= date.today() - date(date.today().year, birth_date.month, birth_date.day) return date.today().year - birth_date.year + (0 if is_after_birthday else -1) def test_full_age(): assert full_age(date(1999, 1, 1)) == 23 assert full_age(date(1999, 8, 8)) == 22 assert full_age(date(2000, 1, 1)) == 22 assert full_age(date(2000, 8, 8)) == 21 assert full_age(date(2020, 1, 1)) == 2 assert full_age(date(2020, 12, 31)) == 1 assert full_age(date(2022, 8, 7)) == 0 def test_counting_age(): assert counting_age(date(2022, 8, 7)) == 1 assert counting_age(date(2020, 1, 1)) == 3 assert counting_age(date(2020, 12, 31)) == 3 assert counting_age(date(1999, 1, 1)) == 24 assert counting_age(date(1999, 8, 8)) == 24 assert counting_age(date(2000, 1, 1)) == 23 assert counting_age(date(2000, 8, 8)) == 23 test_full_age() test_counting_age() try: print(&#39;만 나이: &#39;, full_age(date(1985, 7, 16))) except Exception as error: print(error) try: print(&#39;세는 나이: &#39;, counting_age(date(1985, 7, 16))) except Exception as error: print(error) try: print(&#39;만 나이: &#39;, full_age(date(2985, 7, 16))) except Exception as error: print(error) try: print(&#39;세는 나이: &#39;, counting_age(date(2985, 7, 16))) except Exception as error: print(error) 리스트·사전 등 컬렉션을 중첩한 입체적인 데이터를 파일로 저장하고 읽어 들이기 위해 약속에 따라 입체적인 데이터를 텍스트나 바이트로 표현하는 것을 직렬화(serialization)라고 한다. 코드 11-50 print(&#39;당신의 이름은 무엇인가요?&#39;) name = input() with open(&#39;hello.txt&#39;, &#39;w&#39;) as file: print(name, &#39;님 반가워요.&#39;, file=file) 코드 11-51 from datetime import date today = date.today() text = f&#39;안녕하세요! 오늘은 {today.month}월 {today.day}일입니다.\n&#39; with open(&#39;hello.txt&#39;, &#39;w&#39;) as file: file.write(text) 코드 11-52 from datetime import datetime now = datetime.now() text = f&#39;현재 시각: {now.hour:02}:{now.minute:02}:{now.second:02}\n&#39; with open(&#39;time.txt&#39;, &#39;a&#39;) as file: file.write(text) 코드 11-53 try: with open(&#39;once.text&#39;, &#39;x&#39;) as file: file.write(&#39;이 파일은 한 번만 작성됩니다.&#39;) except FileExistsError: print(&#39;파일이 이미 존재합니다.&#39;) 코드 11-54 with open(&#39;time.txt&#39;, &#39;r&#39;) as file: date = file.read() print(date) 코드 11-55 with open(&#39;time.txt&#39;, &#39;r&#39;) as file: for line in file: print(line, end=&#39;&#39;) 코드 11-56 import csv import pprint with open(&#39;movies.csv&#39;) as file: reader = csv.reader(file) movies = list(reader) pprint.pprint(movies) 코드 11-57 import csv table = [ [&#39;title&#39;, &#39;genre&#39;, &#39;year&#39;], [&#39;Interstellar&#39;, &#39;SF&#39;, &#39;2014&#39;], [&#39;Braveheart&#39;, &#39;Drama&#39;, &#39;1995&#39;], [&#39;Mary Poppins&#39;, &#39;Fantasy&#39;, &#39;1964&#39;], [&#39;Gloomy Sunday&#39;, &#39;Drama&#39;, &#39;2000&#39;], ] with open(&#39;movies_output.csv&#39;, &#39;w&#39;, newline=&#39;&#39;) as file: writer = csv.writer(file) writer.writerows(table) 코드 11-58 import json data = [ { &#39;title&#39;: &#39;Interstellar&#39;, &#39;genre&#39;: &#39;SF&#39;, &#39;year&#39;: 2014, &#39;starring&#39;: [&#39;M. McConaughey&#39;, &#39;A. Hathaway&#39;, &#39;J. Chastain&#39;], }, { &#39;title&#39;: &#39;Mary Poppins&#39;, &#39;genre&#39;: &#39;Fantasy&#39;, &#39;year&#39;: 1964, &#39;starring&#39;: [&#39;J. Andrews&#39;, &#39;D. Van Dyke&#39;], } ] json_data = json.dumps(data) print(json_data) with open(&#39;movies.json&#39;, &#39;w&#39;) as file: file.write(json_data) 코드 11-59 import json import pprint with open(&#39;movies.json&#39;) as file: json_data = file.read() data = json.loads(json_data) pprint.pprint(data) 코드 11-62 from pathlib import Path def ls(path): path_obj = Path(path) for item in path_obj.iterdir(): print(item) print(ls(&#39;/Users&#39;)) # macOS라서 다르게 실습 코드 11-63 from pathlib import Path path = Path(&#39;/Users&#39;) path_list = list(path.iterdir()) print(path_list) print(path_list[0]) print(path_list[0].is_dir()) 코드 11-65 from pathlib import Path path = Path(&#39;/Users&#39;) path_list = list(path.iterdir()) Path(&#39;dir1&#39;).mkdir() Path(&#39;dir2&#39;).mkdir() Path(&#39;file1&#39;).touch() Path(&#39;dir2&#39;).replace(&#39;dir1/dir2&#39;) Path(&#39;dir1/dir2&#39;).replace(Path(&#39;dir2&#39;)) Path(&#39;dir2&#39;).replace(&#39;dir3&#39;) 코드 11-66 from pathlib import Path def mv(src, dst): &quot;&quot;&quot;src 경로의 파일을 dst 경로로 이동한다.&quot;&quot;&quot; src_obj = Path(src) dst_obj = Path(dst) if dst_obj.exists(): raise FileExistsError src_obj.replace(dst_obj) mv(&#39;dir2&#39;, &#39;dir88&#39;) 연습문제 11-4 from pathlib import Path def cp(src, dst): src_obj = Path(src) dst_obj = Path(dst) if not src_obj.exists(): raise FileNotFoundError with open(src_obj, &#39;r&#39;) as file: all_text = file.read() with open(dst_obj, &#39;w&#39;) as file: file.write(all_text) cp(&#39;original.txt&#39;, &#39;clone.txt&#39;) 연습문제 11-4 모범답안처럼 업데이트 def cp(src, dst): with open(src, &#39;r&#39;) as read_file, open(dst, &#39;w&#39;) as write_file: write_file.write(read_file.read()) cp(&#39;original.txt&#39;, &#39;clone.txt&#39;) 연습문제 11-5 import csv # 인구 밀도가 높은 나라부터 낮은 나라 순으로 나라 이름과 인구 밀도를 출력하라. def population_density(population, area): &quot;&quot;&quot;인구 밀도를 구한다.&quot;&quot;&quot; return population / area with open(&#39;population.csv&#39;, &#39;r&#39;) as file: reader = csv.reader(file) countries = list(reader)[1:] country_density = [] for country in countries: country_density.append([country[0], population_density(int(country[1]), int(country[2]))]) sorted_country_density = sorted(country_density, key=lambda country_density: country_density[1], reverse=True) for density in sorted_country_density: print(density[0], density[1]) 연습문제 11-5 모범답안처럼 업데이트 import csv # 인구 밀도가 높은 나라부터 낮은 나라 순으로 나라 이름과 인구 밀도를 출력하라. def population_density(population, area): &quot;&quot;&quot;인구 밀도를 구한다.&quot;&quot;&quot; return population / area with open(&#39;population.csv&#39;, &#39;r&#39;) as file: reader = csv.reader(file) countries = list(reader)[1:] for country in countries: country.append(population_density(int(country[1]), int(country[2]))) sorted_country = sorted(countries, key=lambda row: row[3], reverse=True) for density in sorted_country: print(density[0], density[3]) 부록 A HTTP 통신의 과정 웹브라우저가 en.wikipedia.org 호스트에 /wiki/Python_(programming_language)라는 자원을 요청하는 HTTP 요청 메시지를 발송한다. en.wikipedia.org 호스트가 클라이언트에 HTTP 응답 메시지를 발송한다. 웹브라우저가 응답 메시지를 해석하여 화면에 웹 문서를 출력한다. 파이썬은 URL과 웹 요청에 관련된 모듈들을 urllib 패키지도 묶어 제공한다. urllib.request.urlopen(요청할URL): 응답객체(HTTPResponse)를 반환한다. urllib.request.urlopen(요청할URL).read(): 웹서버가 응답한 데이터를 바이트 배열로 읽어 들임 urllib.request.urlopen(요청할URL).read().decode(&#39;utf-8&#39;): 바이트 배열을 문자열로 변환 HTTPS는 HTTP에 SSL이라는 암·복호화 단계를 적용하여 보안 통신을 수행하는 프로토콜 코드 11-68 import urllib.request def request(url): &quot;&quot;&quot;지정한 url의 웹 문서를 요청하여, 본문을 반환한다.&quot;&quot;&quot; response = urllib.request.urlopen(url) byte_date = response.read() text_data = byte_date.decode(&#39;utf-8&#39;) return text_data 코드 11-69 import urllib.request url = &#39;https://python.bakyeono.net&#39; webpage = urllib.request.urlopen(url).read().decode(&#39;utf-8&#39;) print(webpage) 코드 11-70 import urllib.request url = &#39;https://python.bakyeono.net/data/movies.json&#39; text_data = urllib.request.urlopen(url).read().decode(&#39;-utf-8&#39;) print(text_data) 코드 11-71 import urllib.request import json url = &#39;https://python.bakyeono.net/data/movies.json&#39; text_data = urllib.request.urlopen(url).read().decode(&#39;-utf-8&#39;) movies = json.loads(text_data) sorted_by_year = sorted(movies, key=lambda movie: movie[&#39;year&#39;]) for movie in sorted_by_year: print(str(movie[&#39;year&#39;]) + &#39; &#39; + movie[&#39;title&#39;].upper()) 코드 11-72 import urllib.parse url = &#39;https://python.bakyeono.net/data/movies.json&#39; url_parts = urllib.parse.urlsplit(url) print(url_parts[0]) print(url_parts[1]) print(url_parts[2]) 코드 11-73 import urllib.parse url = &#39;https://python.bakyeono.net/data/movies.json&#39; url_parts = urllib.parse.urlsplit(url) url_parts = list(url_parts) url_parts[2] = &#39;/chapter-11.html&#39; print(urllib.parse.urlunsplit(url_parts)) URL에는 영문자, 숫자, 몇몇 기호들만 사용할 수 있다. 아스키 코드가 아닌 문자들을 퍼센트 인코딩 형식으로 바꾸어야 한다. http.server 모듈로 간단한 웹 서버를 만들 수 있다. 코드 11-78 import http.server class HTTPRequestHandler(http.server.BaseHTTPRequestHandler): def do_GET(self): &quot;&quot;&quot;HTTP GET 요청을 처리한다.&quot;&quot;&quot; self.route() def route(self): &quot;&quot;&quot;요청 URL의 path에 따라 요청을 처리할 함수를 중계한다.&quot;&quot;&quot; if self.path == &#39;/hello&#39;: self.hello() else: self.response_404_not_found() def hello(self): &quot;&quot;&quot;200 OK 상태 코드와 인사말을 응답한다.&quot;&quot;&quot; self.response(200, &#39;안녕하세요?&#39;) def response(self, status_code, body): &quot;&quot;&quot;응답 메시지를 전송한다.&quot;&quot;&quot; self.send_response(status_code) self.send_header(&#39;Content-type&#39;, &#39;text/plain; charset=utf-8&#39;) self.end_headers() self.wfile.write(body.encode(&#39;utf-8&#39;)) ADDRESS = &#39;localhost&#39;, 8000 listener = http.server.HTTPServer(ADDRESS, HTTPRequestHandler) print(f&#39;http://{ADDRESS[0]}:{ADDRESS[1]} 주소에서 요청 대기중...&#39;) listener.serve_forever()" />
<link rel="canonical" href="http://localhost:4000/2022-08-07/yeono-python-15" />
<meta property="og:url" content="http://localhost:4000/2022-08-07/yeono-python-15" />
<meta property="og:site_name" content="주경야독학) 개발공부로그" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-08-07T22:13:19+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="연오의 파이썬 공부 15" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Sunmi Moon","url":"https://moonsunmi.github.io"},"dateModified":"2022-08-07T22:13:19+09:00","datePublished":"2022-08-07T22:13:19+09:00","description":"현재 시간 측정 후 해석 import time now = time.gmtime(time.time()) 시간 단위 다룰 때 많이 쓰는 datetime 모듈 from datetime import time time(15, 30, 45) # 15시 30분 45초 from datetime import datetime datetime(2020, 11, 14, 8, 30) # 2020년 11월 14일 8시 30분 now.isoformat() &#39;2022-08-07T06:44:30.304039&#39; 날짜와 시간을 T로 구별. now.isoformat((sep=&#39; &#39;))와 같이 매개변수로 지정할 수 있다. strftime() 메서드는 양식 문자열을 전달받아 시간 정보 객체를 양식화한다. 코드 11-45 from datetime import timedelta timedelta(days=5) datetime.timedelta(days=5) timedelta(weeks=5) datetime.timedelta(days=35) 연습문제 11-3 -&gt; 논리 오류: 윤년을 생각 못하고, 1년 365일로 계산하였음. from datetime import date class BirthdayException(Exception): &quot;&quot;&quot;생일 오류&quot;&quot;&quot; pass def counting_age(birth_date): &quot;&quot;&quot;생년월일(birth_date)을 입력받아 세는 나이를 반환한다.&quot;&quot;&quot; # 세는 나이는 year 계산 year_gap = date.today().year - birth_date.year if year_gap &lt; 0: raise BirthdayException(&#39;미래에 태어날 사람의 나이는 계산할 수 없습니다.&#39;) return year_gap + 1 def full_age(birth_date): &quot;&quot;&quot;생년월일(birth_date)을 입력받아 만 나이를 반환한다.&quot;&quot;&quot; # 만 나이는 day 계산 day_gap = date.today() - birth_date if day_gap.days &lt; 0: raise BirthdayException(&#39;미래에 태어날 사람의 나이는 계산할 수 없습니다.&#39;) return day_gap.days // 365 def test_full_age(): assert full_age(date(2022, 8, 7)) == 0 assert full_age(date(2020, 1, 1)) == 2 assert full_age(date(2020, 12, 31)) == 1 def test_counting_age(): assert counting_age(date(2022, 8, 7)) == 1 assert counting_age(date(2020, 1, 1)) == 3 assert counting_age(date(2020, 12, 31)) == 3 test_full_age() test_counting_age() try: print(&#39;만 나이: &#39;, full_age(date(1985, 7, 16))) except Exception as error: print(error) try: print(&#39;세는 나이: &#39;, counting_age(date(1985, 7, 16))) except Exception as error: print(error) try: print(&#39;만 나이: &#39;, full_age(date(2985, 7, 16))) except Exception as error: print(error) try: print(&#39;세는 나이: &#39;, counting_age(date(2985, 7, 16))) except Exception as error: print(error) 연습문제 11-3 update # 논리 오류: 윤년을 생각 못하고, 1년을 365일로 고정하여 계산함. from datetime import date, timedelta class BirthdayException(Exception): &quot;&quot;&quot;생일 오류&quot;&quot;&quot; pass def counting_age(birth_date): &quot;&quot;&quot;생년월일(birth_date)을 입력받아 세는 나이를 반환한다.&quot;&quot;&quot; # 세는 나이는 year 계산 year_gap = date.today().year - birth_date.year if year_gap &lt; 0: raise BirthdayException(&#39;미래에 태어날 사람의 나이는 계산할 수 없습니다.&#39;) return year_gap + 1 def full_age(birth_date): &quot;&quot;&quot;생년월일(birth_date)을 입력받아 만 나이를 반환한다.&quot;&quot;&quot; # 만 나이는 day 계산 day_gap = date.today() - birth_date if day_gap.days &lt; 0: raise BirthdayException(&#39;미래에 태어날 사람의 나이는 계산할 수 없습니다.&#39;) is_after_birthday = timedelta(0) &lt;= date.today() - date(date.today().year, birth_date.month, birth_date.day) return date.today().year - birth_date.year + (0 if is_after_birthday else -1) def test_full_age(): assert full_age(date(1999, 1, 1)) == 23 assert full_age(date(1999, 8, 8)) == 22 assert full_age(date(2000, 1, 1)) == 22 assert full_age(date(2000, 8, 8)) == 21 assert full_age(date(2020, 1, 1)) == 2 assert full_age(date(2020, 12, 31)) == 1 assert full_age(date(2022, 8, 7)) == 0 def test_counting_age(): assert counting_age(date(2022, 8, 7)) == 1 assert counting_age(date(2020, 1, 1)) == 3 assert counting_age(date(2020, 12, 31)) == 3 assert counting_age(date(1999, 1, 1)) == 24 assert counting_age(date(1999, 8, 8)) == 24 assert counting_age(date(2000, 1, 1)) == 23 assert counting_age(date(2000, 8, 8)) == 23 test_full_age() test_counting_age() try: print(&#39;만 나이: &#39;, full_age(date(1985, 7, 16))) except Exception as error: print(error) try: print(&#39;세는 나이: &#39;, counting_age(date(1985, 7, 16))) except Exception as error: print(error) try: print(&#39;만 나이: &#39;, full_age(date(2985, 7, 16))) except Exception as error: print(error) try: print(&#39;세는 나이: &#39;, counting_age(date(2985, 7, 16))) except Exception as error: print(error) 리스트·사전 등 컬렉션을 중첩한 입체적인 데이터를 파일로 저장하고 읽어 들이기 위해 약속에 따라 입체적인 데이터를 텍스트나 바이트로 표현하는 것을 직렬화(serialization)라고 한다. 코드 11-50 print(&#39;당신의 이름은 무엇인가요?&#39;) name = input() with open(&#39;hello.txt&#39;, &#39;w&#39;) as file: print(name, &#39;님 반가워요.&#39;, file=file) 코드 11-51 from datetime import date today = date.today() text = f&#39;안녕하세요! 오늘은 {today.month}월 {today.day}일입니다.\\n&#39; with open(&#39;hello.txt&#39;, &#39;w&#39;) as file: file.write(text) 코드 11-52 from datetime import datetime now = datetime.now() text = f&#39;현재 시각: {now.hour:02}:{now.minute:02}:{now.second:02}\\n&#39; with open(&#39;time.txt&#39;, &#39;a&#39;) as file: file.write(text) 코드 11-53 try: with open(&#39;once.text&#39;, &#39;x&#39;) as file: file.write(&#39;이 파일은 한 번만 작성됩니다.&#39;) except FileExistsError: print(&#39;파일이 이미 존재합니다.&#39;) 코드 11-54 with open(&#39;time.txt&#39;, &#39;r&#39;) as file: date = file.read() print(date) 코드 11-55 with open(&#39;time.txt&#39;, &#39;r&#39;) as file: for line in file: print(line, end=&#39;&#39;) 코드 11-56 import csv import pprint with open(&#39;movies.csv&#39;) as file: reader = csv.reader(file) movies = list(reader) pprint.pprint(movies) 코드 11-57 import csv table = [ [&#39;title&#39;, &#39;genre&#39;, &#39;year&#39;], [&#39;Interstellar&#39;, &#39;SF&#39;, &#39;2014&#39;], [&#39;Braveheart&#39;, &#39;Drama&#39;, &#39;1995&#39;], [&#39;Mary Poppins&#39;, &#39;Fantasy&#39;, &#39;1964&#39;], [&#39;Gloomy Sunday&#39;, &#39;Drama&#39;, &#39;2000&#39;], ] with open(&#39;movies_output.csv&#39;, &#39;w&#39;, newline=&#39;&#39;) as file: writer = csv.writer(file) writer.writerows(table) 코드 11-58 import json data = [ { &#39;title&#39;: &#39;Interstellar&#39;, &#39;genre&#39;: &#39;SF&#39;, &#39;year&#39;: 2014, &#39;starring&#39;: [&#39;M. McConaughey&#39;, &#39;A. Hathaway&#39;, &#39;J. Chastain&#39;], }, { &#39;title&#39;: &#39;Mary Poppins&#39;, &#39;genre&#39;: &#39;Fantasy&#39;, &#39;year&#39;: 1964, &#39;starring&#39;: [&#39;J. Andrews&#39;, &#39;D. Van Dyke&#39;], } ] json_data = json.dumps(data) print(json_data) with open(&#39;movies.json&#39;, &#39;w&#39;) as file: file.write(json_data) 코드 11-59 import json import pprint with open(&#39;movies.json&#39;) as file: json_data = file.read() data = json.loads(json_data) pprint.pprint(data) 코드 11-62 from pathlib import Path def ls(path): path_obj = Path(path) for item in path_obj.iterdir(): print(item) print(ls(&#39;/Users&#39;)) # macOS라서 다르게 실습 코드 11-63 from pathlib import Path path = Path(&#39;/Users&#39;) path_list = list(path.iterdir()) print(path_list) print(path_list[0]) print(path_list[0].is_dir()) 코드 11-65 from pathlib import Path path = Path(&#39;/Users&#39;) path_list = list(path.iterdir()) Path(&#39;dir1&#39;).mkdir() Path(&#39;dir2&#39;).mkdir() Path(&#39;file1&#39;).touch() Path(&#39;dir2&#39;).replace(&#39;dir1/dir2&#39;) Path(&#39;dir1/dir2&#39;).replace(Path(&#39;dir2&#39;)) Path(&#39;dir2&#39;).replace(&#39;dir3&#39;) 코드 11-66 from pathlib import Path def mv(src, dst): &quot;&quot;&quot;src 경로의 파일을 dst 경로로 이동한다.&quot;&quot;&quot; src_obj = Path(src) dst_obj = Path(dst) if dst_obj.exists(): raise FileExistsError src_obj.replace(dst_obj) mv(&#39;dir2&#39;, &#39;dir88&#39;) 연습문제 11-4 from pathlib import Path def cp(src, dst): src_obj = Path(src) dst_obj = Path(dst) if not src_obj.exists(): raise FileNotFoundError with open(src_obj, &#39;r&#39;) as file: all_text = file.read() with open(dst_obj, &#39;w&#39;) as file: file.write(all_text) cp(&#39;original.txt&#39;, &#39;clone.txt&#39;) 연습문제 11-4 모범답안처럼 업데이트 def cp(src, dst): with open(src, &#39;r&#39;) as read_file, open(dst, &#39;w&#39;) as write_file: write_file.write(read_file.read()) cp(&#39;original.txt&#39;, &#39;clone.txt&#39;) 연습문제 11-5 import csv # 인구 밀도가 높은 나라부터 낮은 나라 순으로 나라 이름과 인구 밀도를 출력하라. def population_density(population, area): &quot;&quot;&quot;인구 밀도를 구한다.&quot;&quot;&quot; return population / area with open(&#39;population.csv&#39;, &#39;r&#39;) as file: reader = csv.reader(file) countries = list(reader)[1:] country_density = [] for country in countries: country_density.append([country[0], population_density(int(country[1]), int(country[2]))]) sorted_country_density = sorted(country_density, key=lambda country_density: country_density[1], reverse=True) for density in sorted_country_density: print(density[0], density[1]) 연습문제 11-5 모범답안처럼 업데이트 import csv # 인구 밀도가 높은 나라부터 낮은 나라 순으로 나라 이름과 인구 밀도를 출력하라. def population_density(population, area): &quot;&quot;&quot;인구 밀도를 구한다.&quot;&quot;&quot; return population / area with open(&#39;population.csv&#39;, &#39;r&#39;) as file: reader = csv.reader(file) countries = list(reader)[1:] for country in countries: country.append(population_density(int(country[1]), int(country[2]))) sorted_country = sorted(countries, key=lambda row: row[3], reverse=True) for density in sorted_country: print(density[0], density[3]) 부록 A HTTP 통신의 과정 웹브라우저가 en.wikipedia.org 호스트에 /wiki/Python_(programming_language)라는 자원을 요청하는 HTTP 요청 메시지를 발송한다. en.wikipedia.org 호스트가 클라이언트에 HTTP 응답 메시지를 발송한다. 웹브라우저가 응답 메시지를 해석하여 화면에 웹 문서를 출력한다. 파이썬은 URL과 웹 요청에 관련된 모듈들을 urllib 패키지도 묶어 제공한다. urllib.request.urlopen(요청할URL): 응답객체(HTTPResponse)를 반환한다. urllib.request.urlopen(요청할URL).read(): 웹서버가 응답한 데이터를 바이트 배열로 읽어 들임 urllib.request.urlopen(요청할URL).read().decode(&#39;utf-8&#39;): 바이트 배열을 문자열로 변환 HTTPS는 HTTP에 SSL이라는 암·복호화 단계를 적용하여 보안 통신을 수행하는 프로토콜 코드 11-68 import urllib.request def request(url): &quot;&quot;&quot;지정한 url의 웹 문서를 요청하여, 본문을 반환한다.&quot;&quot;&quot; response = urllib.request.urlopen(url) byte_date = response.read() text_data = byte_date.decode(&#39;utf-8&#39;) return text_data 코드 11-69 import urllib.request url = &#39;https://python.bakyeono.net&#39; webpage = urllib.request.urlopen(url).read().decode(&#39;utf-8&#39;) print(webpage) 코드 11-70 import urllib.request url = &#39;https://python.bakyeono.net/data/movies.json&#39; text_data = urllib.request.urlopen(url).read().decode(&#39;-utf-8&#39;) print(text_data) 코드 11-71 import urllib.request import json url = &#39;https://python.bakyeono.net/data/movies.json&#39; text_data = urllib.request.urlopen(url).read().decode(&#39;-utf-8&#39;) movies = json.loads(text_data) sorted_by_year = sorted(movies, key=lambda movie: movie[&#39;year&#39;]) for movie in sorted_by_year: print(str(movie[&#39;year&#39;]) + &#39; &#39; + movie[&#39;title&#39;].upper()) 코드 11-72 import urllib.parse url = &#39;https://python.bakyeono.net/data/movies.json&#39; url_parts = urllib.parse.urlsplit(url) print(url_parts[0]) print(url_parts[1]) print(url_parts[2]) 코드 11-73 import urllib.parse url = &#39;https://python.bakyeono.net/data/movies.json&#39; url_parts = urllib.parse.urlsplit(url) url_parts = list(url_parts) url_parts[2] = &#39;/chapter-11.html&#39; print(urllib.parse.urlunsplit(url_parts)) URL에는 영문자, 숫자, 몇몇 기호들만 사용할 수 있다. 아스키 코드가 아닌 문자들을 퍼센트 인코딩 형식으로 바꾸어야 한다. http.server 모듈로 간단한 웹 서버를 만들 수 있다. 코드 11-78 import http.server class HTTPRequestHandler(http.server.BaseHTTPRequestHandler): def do_GET(self): &quot;&quot;&quot;HTTP GET 요청을 처리한다.&quot;&quot;&quot; self.route() def route(self): &quot;&quot;&quot;요청 URL의 path에 따라 요청을 처리할 함수를 중계한다.&quot;&quot;&quot; if self.path == &#39;/hello&#39;: self.hello() else: self.response_404_not_found() def hello(self): &quot;&quot;&quot;200 OK 상태 코드와 인사말을 응답한다.&quot;&quot;&quot; self.response(200, &#39;안녕하세요?&#39;) def response(self, status_code, body): &quot;&quot;&quot;응답 메시지를 전송한다.&quot;&quot;&quot; self.send_response(status_code) self.send_header(&#39;Content-type&#39;, &#39;text/plain; charset=utf-8&#39;) self.end_headers() self.wfile.write(body.encode(&#39;utf-8&#39;)) ADDRESS = &#39;localhost&#39;, 8000 listener = http.server.HTTPServer(ADDRESS, HTTPRequestHandler) print(f&#39;http://{ADDRESS[0]}:{ADDRESS[1]} 주소에서 요청 대기중...&#39;) listener.serve_forever()","headline":"연오의 파이썬 공부 15","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2022-08-07/yeono-python-15"},"url":"http://localhost:4000/2022-08-07/yeono-python-15"}</script>
<!-- End Jekyll SEO tag -->


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">

  <!-- RSS -->
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="주경야독학) 개발공부로그" />

  <!-- Google Analytics-->
  
</head>


  <body>
    <nav class="nav">
  <div class="nav-container">
    <a href="/">
      <h2 class="nav-title">주경야독학) 개발공부로그</h2>
    </a>
    <ul>
      <li><a href="/">Posts</a></li>
      <li><a href="/tags">Tags</a></li>
      <li><a href="/about">About</a></li>
    </ul>
  </div>
</nav>


    <main><div class="post">
  <h1 class="post-title">연오의 파이썬 공부 15</h1>

  <div class="post-info">
    
    <br />
    <span>on&nbsp;</span
    ><time datetime="2022-08-07 22:13:19 +0900">August 07, 2022</time>
    
  </div>

  <p>현재 시간 측정 후 해석</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">time</span>
<span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">gmtime</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span>
</code></pre></div></div>

<p>시간 단위 다룰 때 많이 쓰는 datetime 모듈</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">time</span>
<span class="n">time</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span> <span class="c1"># 15시 30분 45초
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from datetime import datetime
datetime(2020, 11, 14, 8, 30)  # 2020년 11월 14일 8시 30분
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>now.isoformat()
'2022-08-07T06:44:30.304039'
</code></pre></div></div>

<p>날짜와 시간을 <code class="language-plaintext highlighter-rouge">T</code>로 구별. <code class="language-plaintext highlighter-rouge">now.isoformat((sep=' '))</code>와 같이 매개변수로 지정할 수 있다.</p>

<p><code class="language-plaintext highlighter-rouge">strftime()</code> 메서드는 양식 문자열을 전달받아 시간 정보 객체를 양식화한다.</p>

<p>코드 11-45</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>
<span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">datetime</span><span class="p">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">timedelta</span><span class="p">(</span><span class="n">weeks</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">datetime</span><span class="p">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</code></pre></div></div>

<p>연습문제 11-3 -&gt; 논리 오류: 윤년을 생각 못하고, 1년 365일로 계산하였음.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>


<span class="k">class</span> <span class="nc">BirthdayException</span><span class="p">(</span><span class="nb">Exception</span><span class="p">):</span>
   <span class="s">"""생일 오류"""</span>
   <span class="k">pass</span>


<span class="k">def</span> <span class="nf">counting_age</span><span class="p">(</span><span class="n">birth_date</span><span class="p">):</span>
   <span class="s">"""생년월일(birth_date)을 입력받아 세는 나이를 반환한다."""</span>
   <span class="c1"># 세는 나이는 year 계산
</span>   <span class="n">year_gap</span> <span class="o">=</span> <span class="n">date</span><span class="p">.</span><span class="n">today</span><span class="p">().</span><span class="n">year</span> <span class="o">-</span> <span class="n">birth_date</span><span class="p">.</span><span class="n">year</span>
   <span class="k">if</span> <span class="n">year_gap</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
       <span class="k">raise</span> <span class="n">BirthdayException</span><span class="p">(</span><span class="s">'미래에 태어날 사람의 나이는 계산할 수 없습니다.'</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">year_gap</span> <span class="o">+</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">full_age</span><span class="p">(</span><span class="n">birth_date</span><span class="p">):</span>
   <span class="s">"""생년월일(birth_date)을 입력받아 만 나이를 반환한다."""</span>
   <span class="c1"># 만 나이는 day 계산
</span>   <span class="n">day_gap</span> <span class="o">=</span> <span class="n">date</span><span class="p">.</span><span class="n">today</span><span class="p">()</span> <span class="o">-</span> <span class="n">birth_date</span>
   <span class="k">if</span> <span class="n">day_gap</span><span class="p">.</span><span class="n">days</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
       <span class="k">raise</span> <span class="n">BirthdayException</span><span class="p">(</span><span class="s">'미래에 태어날 사람의 나이는 계산할 수 없습니다.'</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">day_gap</span><span class="p">.</span><span class="n">days</span> <span class="o">//</span> <span class="mi">365</span>


<span class="k">def</span> <span class="nf">test_full_age</span><span class="p">():</span>
   <span class="k">assert</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span>
   <span class="k">assert</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span>
   <span class="k">assert</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">test_counting_age</span><span class="p">():</span>
   <span class="k">assert</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
   <span class="k">assert</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span>
   <span class="k">assert</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span>


<span class="n">test_full_age</span><span class="p">()</span>
<span class="n">test_counting_age</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="s">'만 나이: '</span><span class="p">,</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">1985</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">)))</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="s">'세는 나이: '</span><span class="p">,</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">1985</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">)))</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="s">'만 나이: '</span><span class="p">,</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2985</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">)))</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="s">'세는 나이: '</span><span class="p">,</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2985</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">)))</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</code></pre></div></div>

<p>연습문제 11-3 update</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 논리 오류: 윤년을 생각 못하고, 1년을 365일로 고정하여 계산함.
</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span><span class="p">,</span> <span class="n">timedelta</span>


<span class="k">class</span> <span class="nc">BirthdayException</span><span class="p">(</span><span class="nb">Exception</span><span class="p">):</span>
   <span class="s">"""생일 오류"""</span>
   <span class="k">pass</span>


<span class="k">def</span> <span class="nf">counting_age</span><span class="p">(</span><span class="n">birth_date</span><span class="p">):</span>
   <span class="s">"""생년월일(birth_date)을 입력받아 세는 나이를 반환한다."""</span>
   <span class="c1"># 세는 나이는 year 계산
</span>   <span class="n">year_gap</span> <span class="o">=</span> <span class="n">date</span><span class="p">.</span><span class="n">today</span><span class="p">().</span><span class="n">year</span> <span class="o">-</span> <span class="n">birth_date</span><span class="p">.</span><span class="n">year</span>
   <span class="k">if</span> <span class="n">year_gap</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
       <span class="k">raise</span> <span class="n">BirthdayException</span><span class="p">(</span><span class="s">'미래에 태어날 사람의 나이는 계산할 수 없습니다.'</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">year_gap</span> <span class="o">+</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">full_age</span><span class="p">(</span><span class="n">birth_date</span><span class="p">):</span>
   <span class="s">"""생년월일(birth_date)을 입력받아 만 나이를 반환한다."""</span>
   <span class="c1"># 만 나이는 day 계산
</span>   <span class="n">day_gap</span> <span class="o">=</span> <span class="n">date</span><span class="p">.</span><span class="n">today</span><span class="p">()</span> <span class="o">-</span> <span class="n">birth_date</span>

   <span class="k">if</span> <span class="n">day_gap</span><span class="p">.</span><span class="n">days</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
       <span class="k">raise</span> <span class="n">BirthdayException</span><span class="p">(</span><span class="s">'미래에 태어날 사람의 나이는 계산할 수 없습니다.'</span><span class="p">)</span>

   <span class="n">is_after_birthday</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">date</span><span class="p">.</span><span class="n">today</span><span class="p">()</span> <span class="o">-</span> <span class="n">date</span><span class="p">(</span><span class="n">date</span><span class="p">.</span><span class="n">today</span><span class="p">().</span><span class="n">year</span><span class="p">,</span> <span class="n">birth_date</span><span class="p">.</span><span class="n">month</span><span class="p">,</span> <span class="n">birth_date</span><span class="p">.</span><span class="n">day</span><span class="p">)</span>

   <span class="k">return</span> <span class="n">date</span><span class="p">.</span><span class="n">today</span><span class="p">().</span><span class="n">year</span> <span class="o">-</span> <span class="n">birth_date</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">is_after_birthday</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_full_age</span><span class="p">():</span>

   <span class="k">assert</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">1999</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="mi">23</span>
   <span class="k">assert</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">1999</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="o">==</span> <span class="mi">22</span>
   <span class="k">assert</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="mi">22</span>
   <span class="k">assert</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="o">==</span> <span class="mi">21</span>

   <span class="k">assert</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span>
   <span class="k">assert</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
   <span class="k">assert</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span>


<span class="k">def</span> <span class="nf">test_counting_age</span><span class="p">():</span>
   <span class="k">assert</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
   <span class="k">assert</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span>
   <span class="k">assert</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span>

   <span class="k">assert</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">1999</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="mi">24</span>
   <span class="k">assert</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">1999</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="o">==</span> <span class="mi">24</span>
   <span class="k">assert</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="mi">23</span>
   <span class="k">assert</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="o">==</span> <span class="mi">23</span>


<span class="n">test_full_age</span><span class="p">()</span>
<span class="n">test_counting_age</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="s">'만 나이: '</span><span class="p">,</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">1985</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">)))</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="s">'세는 나이: '</span><span class="p">,</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">1985</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">)))</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="s">'만 나이: '</span><span class="p">,</span> <span class="n">full_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2985</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">)))</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="s">'세는 나이: '</span><span class="p">,</span> <span class="n">counting_age</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2985</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">)))</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</code></pre></div></div>

<p>리스트·사전 등 컬렉션을 중첩한 입체적인 데이터를 파일로 저장하고 읽어 들이기 위해
약속에 따라 입체적인 데이터를 텍스트나 바이트로 표현하는 것을 직렬화(serialization)라고 한다.</p>

<p>코드 11-50</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">'당신의 이름은 무엇인가요?'</span><span class="p">)</span>
<span class="n">name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'hello.txt'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">'님 반가워요.'</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="nb">file</span><span class="p">)</span>
</code></pre></div></div>

<p>코드 11-51</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="n">today</span> <span class="o">=</span> <span class="n">date</span><span class="p">.</span><span class="n">today</span><span class="p">()</span>

<span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'안녕하세요! 오늘은 </span><span class="si">{</span><span class="n">today</span><span class="p">.</span><span class="n">month</span><span class="si">}</span><span class="s">월 </span><span class="si">{</span><span class="n">today</span><span class="p">.</span><span class="n">day</span><span class="si">}</span><span class="s">일입니다.</span><span class="se">\n</span><span class="s">'</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'hello.txt'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
   <span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div></div>

<p>코드 11-52</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>

<span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'현재 시각: </span><span class="si">{</span><span class="n">now</span><span class="p">.</span><span class="n">hour</span><span class="si">:</span><span class="mi">02</span><span class="si">}</span><span class="s">:</span><span class="si">{</span><span class="n">now</span><span class="p">.</span><span class="n">minute</span><span class="si">:</span><span class="mi">02</span><span class="si">}</span><span class="s">:</span><span class="si">{</span><span class="n">now</span><span class="p">.</span><span class="n">second</span><span class="si">:</span><span class="mi">02</span><span class="si">}</span><span class="se">\n</span><span class="s">'</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'time.txt'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
   <span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div></div>

<p>코드 11-53</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span><span class="p">:</span>
   <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'once.text'</span><span class="p">,</span> <span class="s">'x'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
       <span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'이 파일은 한 번만 작성됩니다.'</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">FileExistsError</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="s">'파일이 이미 존재합니다.'</span><span class="p">)</span>
</code></pre></div></div>

<p>코드 11-54</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'time.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
   <span class="n">date</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
</code></pre></div></div>

<p>코드 11-55</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'time.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
   <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">file</span><span class="p">:</span>
       <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">''</span><span class="p">)</span>
</code></pre></div></div>

<p>코드 11-56</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">pprint</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'movies.csv'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
   <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="p">.</span><span class="n">reader</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
   <span class="n">movies</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>

<span class="n">pprint</span><span class="p">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">movies</span><span class="p">)</span>
</code></pre></div></div>

<p>코드 11-57</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">csv</span>

<span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
   <span class="p">[</span><span class="s">'title'</span><span class="p">,</span> <span class="s">'genre'</span><span class="p">,</span> <span class="s">'year'</span><span class="p">],</span>
   <span class="p">[</span><span class="s">'Interstellar'</span><span class="p">,</span> <span class="s">'SF'</span><span class="p">,</span> <span class="s">'2014'</span><span class="p">],</span>
   <span class="p">[</span><span class="s">'Braveheart'</span><span class="p">,</span> <span class="s">'Drama'</span><span class="p">,</span> <span class="s">'1995'</span><span class="p">],</span>
   <span class="p">[</span><span class="s">'Mary Poppins'</span><span class="p">,</span> <span class="s">'Fantasy'</span><span class="p">,</span> <span class="s">'1964'</span><span class="p">],</span>
   <span class="p">[</span><span class="s">'Gloomy Sunday'</span><span class="p">,</span> <span class="s">'Drama'</span><span class="p">,</span> <span class="s">'2000'</span><span class="p">],</span>
<span class="p">]</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'movies_output.csv'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">''</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
   <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="p">.</span><span class="n">writer</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
   <span class="n">writer</span><span class="p">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</code></pre></div></div>

<p>코드 11-58</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">json</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
   <span class="p">{</span>
       <span class="s">'title'</span><span class="p">:</span> <span class="s">'Interstellar'</span><span class="p">,</span>
       <span class="s">'genre'</span><span class="p">:</span> <span class="s">'SF'</span><span class="p">,</span>
       <span class="s">'year'</span><span class="p">:</span> <span class="mi">2014</span><span class="p">,</span>
       <span class="s">'starring'</span><span class="p">:</span> <span class="p">[</span><span class="s">'M. McConaughey'</span><span class="p">,</span> <span class="s">'A. Hathaway'</span><span class="p">,</span> <span class="s">'J. Chastain'</span><span class="p">],</span>
   <span class="p">},</span>
   <span class="p">{</span>
       <span class="s">'title'</span><span class="p">:</span> <span class="s">'Mary Poppins'</span><span class="p">,</span>
       <span class="s">'genre'</span><span class="p">:</span> <span class="s">'Fantasy'</span><span class="p">,</span>
       <span class="s">'year'</span><span class="p">:</span> <span class="mi">1964</span><span class="p">,</span>
       <span class="s">'starring'</span><span class="p">:</span> <span class="p">[</span><span class="s">'J. Andrews'</span><span class="p">,</span> <span class="s">'D. Van Dyke'</span><span class="p">],</span>
   <span class="p">}</span>
<span class="p">]</span>

<span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'movies.json'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
   <span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>
</code></pre></div></div>

<p>코드 11-59</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">pprint</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'movies.json'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
   <span class="n">json_data</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>



<span class="n">코드</span> <span class="mi">11</span><span class="o">-</span><span class="mi">62</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="k">def</span> <span class="nf">ls</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
   <span class="n">path_obj</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

   <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">path_obj</span><span class="p">.</span><span class="n">iterdir</span><span class="p">():</span>
       <span class="k">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">ls</span><span class="p">(</span><span class="s">'/Users'</span><span class="p">))</span> <span class="c1"># macOS라서 다르게 실습
</span></code></pre></div></div>

<p>코드 11-63</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s">'/Users'</span><span class="p">)</span>
<span class="n">path_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">iterdir</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">path_list</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">path_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">path_list</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">is_dir</span><span class="p">())</span>
</code></pre></div></div>

<p>코드 11-65</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s">'/Users'</span><span class="p">)</span>
<span class="n">path_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">iterdir</span><span class="p">())</span>

<span class="n">Path</span><span class="p">(</span><span class="s">'dir1'</span><span class="p">).</span><span class="n">mkdir</span><span class="p">()</span>
<span class="n">Path</span><span class="p">(</span><span class="s">'dir2'</span><span class="p">).</span><span class="n">mkdir</span><span class="p">()</span>
<span class="n">Path</span><span class="p">(</span><span class="s">'file1'</span><span class="p">).</span><span class="n">touch</span><span class="p">()</span>

<span class="n">Path</span><span class="p">(</span><span class="s">'dir2'</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'dir1/dir2'</span><span class="p">)</span>
<span class="n">Path</span><span class="p">(</span><span class="s">'dir1/dir2'</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s">'dir2'</span><span class="p">))</span>
<span class="n">Path</span><span class="p">(</span><span class="s">'dir2'</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'dir3'</span><span class="p">)</span>
</code></pre></div></div>

<p>코드 11-66</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="k">def</span> <span class="nf">mv</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
   <span class="s">"""src 경로의 파일을 dst 경로로 이동한다."""</span>
   <span class="n">src_obj</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
   <span class="n">dst_obj</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>

   <span class="k">if</span> <span class="n">dst_obj</span><span class="p">.</span><span class="n">exists</span><span class="p">():</span>
       <span class="k">raise</span> <span class="nb">FileExistsError</span>
   <span class="n">src_obj</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="n">dst_obj</span><span class="p">)</span>

<span class="n">mv</span><span class="p">(</span><span class="s">'dir2'</span><span class="p">,</span> <span class="s">'dir88'</span><span class="p">)</span>
</code></pre></div></div>

<p>연습문제 11-4</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>


<span class="k">def</span> <span class="nf">cp</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
   <span class="n">src_obj</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
   <span class="n">dst_obj</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>

   <span class="k">if</span> <span class="ow">not</span> <span class="n">src_obj</span><span class="p">.</span><span class="n">exists</span><span class="p">():</span>
       <span class="k">raise</span> <span class="nb">FileNotFoundError</span>

   <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">src_obj</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
       <span class="n">all_text</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

   <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dst_obj</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
       <span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">all_text</span><span class="p">)</span>


<span class="n">cp</span><span class="p">(</span><span class="s">'original.txt'</span><span class="p">,</span> <span class="s">'clone.txt'</span><span class="p">)</span>
</code></pre></div></div>

<p>연습문제 11-4 모범답안처럼 업데이트</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">cp</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>

   <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">read_file</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">write_file</span><span class="p">:</span>
       <span class="n">write_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">read_file</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>


<span class="n">cp</span><span class="p">(</span><span class="s">'original.txt'</span><span class="p">,</span> <span class="s">'clone.txt'</span><span class="p">)</span>
</code></pre></div></div>

<p>연습문제 11-5</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">csv</span>

<span class="c1"># 인구 밀도가 높은 나라부터 낮은 나라 순으로 나라 이름과 인구 밀도를 출력하라.
</span>

<span class="k">def</span> <span class="nf">population_density</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">area</span><span class="p">):</span>
   <span class="s">"""인구 밀도를 구한다."""</span>
   <span class="k">return</span> <span class="n">population</span> <span class="o">/</span> <span class="n">area</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'population.csv'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
   <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="p">.</span><span class="n">reader</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
   <span class="n">countries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">country_density</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">countries</span><span class="p">:</span>
   <span class="n">country_density</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">country</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">population_density</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">country</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">country</span><span class="p">[</span><span class="mi">2</span><span class="p">]))])</span>

<span class="n">sorted_country_density</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">country_density</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">country_density</span><span class="p">:</span> <span class="n">country_density</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">density</span> <span class="ow">in</span> <span class="n">sorted_country_density</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">density</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">density</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<p>연습문제 11-5 모범답안처럼 업데이트</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">csv</span>


<span class="c1"># 인구 밀도가 높은 나라부터 낮은 나라 순으로 나라 이름과 인구 밀도를 출력하라.
</span><span class="k">def</span> <span class="nf">population_density</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">area</span><span class="p">):</span>
   <span class="s">"""인구 밀도를 구한다."""</span>
   <span class="k">return</span> <span class="n">population</span> <span class="o">/</span> <span class="n">area</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'population.csv'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
   <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="p">.</span><span class="n">reader</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
   <span class="n">countries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>

<span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">countries</span><span class="p">:</span>
   <span class="n">country</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">population_density</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">country</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">country</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>

<span class="n">sorted_country</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">density</span> <span class="ow">in</span> <span class="n">sorted_country</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">density</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">density</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</code></pre></div></div>

<h2 id="부록-a">부록 A</h2>

<p>HTTP 통신의 과정</p>

<ol>
  <li>웹브라우저가 en.wikipedia.org 호스트에 /wiki/Python_(programming_language)라는 자원을 요청하는 HTTP 요청 메시지를 발송한다.</li>
  <li>en.wikipedia.org 호스트가 클라이언트에 HTTP 응답 메시지를 발송한다.</li>
  <li>웹브라우저가 응답 메시지를 해석하여 화면에 웹 문서를 출력한다.</li>
</ol>

<p>파이썬은 URL과 웹 요청에 관련된 모듈들을 urllib 패키지도 묶어 제공한다.</p>

<p><code class="language-plaintext highlighter-rouge">urllib.request.urlopen(요청할URL)</code>: 응답객체(HTTPResponse)를 반환한다.
<code class="language-plaintext highlighter-rouge">urllib.request.urlopen(요청할URL).read()</code>: 웹서버가 응답한 데이터를 바이트 배열로 읽어 들임
<code class="language-plaintext highlighter-rouge">urllib.request.urlopen(요청할URL).read().decode('utf-8')</code>: 바이트 배열을 문자열로 변환</p>

<p>HTTPS는 HTTP에 SSL이라는 암·복호화 단계를 적용하여 보안 통신을 수행하는 프로토콜</p>

<p>코드 11-68</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="k">def</span> <span class="nf">request</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
   <span class="s">"""지정한 url의 웹 문서를 요청하여, 본문을 반환한다."""</span>
   <span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
   <span class="n">byte_date</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
   <span class="n">text_data</span> <span class="o">=</span> <span class="n">byte_date</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">text_data</span>
</code></pre></div></div>

<p>코드 11-69</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">urllib.request</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">'https://python.bakyeono.net'</span>
<span class="n">webpage</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">read</span><span class="p">().</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">webpage</span><span class="p">)</span>
</code></pre></div></div>

<p>코드 11-70</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">urllib.request</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">'https://python.bakyeono.net/data/movies.json'</span>
<span class="n">text_data</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">read</span><span class="p">().</span><span class="n">decode</span><span class="p">(</span><span class="s">'-utf-8'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">text_data</span><span class="p">)</span>
</code></pre></div></div>

<p>코드 11-71</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">'https://python.bakyeono.net/data/movies.json'</span>
<span class="n">text_data</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">read</span><span class="p">().</span><span class="n">decode</span><span class="p">(</span><span class="s">'-utf-8'</span><span class="p">)</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">text_data</span><span class="p">)</span>
<span class="n">sorted_by_year</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">movies</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">movie</span><span class="p">:</span> <span class="n">movie</span><span class="p">[</span><span class="s">'year'</span><span class="p">])</span>

<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">sorted_by_year</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">movie</span><span class="p">[</span><span class="s">'year'</span><span class="p">])</span> <span class="o">+</span> <span class="s">' '</span> <span class="o">+</span> <span class="n">movie</span><span class="p">[</span><span class="s">'title'</span><span class="p">].</span><span class="n">upper</span><span class="p">())</span>
</code></pre></div></div>

<p>코드 11-72</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">urllib.parse</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">'https://python.bakyeono.net/data/movies.json'</span>
<span class="n">url_parts</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">urlsplit</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">url_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">url_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">url_parts</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</code></pre></div></div>

<p>코드 11-73</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">urllib.parse</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">'https://python.bakyeono.net/data/movies.json'</span>
<span class="n">url_parts</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">urlsplit</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">url_parts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">url_parts</span><span class="p">)</span>
<span class="n">url_parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s">'/chapter-11.html'</span>
<span class="k">print</span><span class="p">(</span><span class="n">urllib</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">urlunsplit</span><span class="p">(</span><span class="n">url_parts</span><span class="p">))</span>
</code></pre></div></div>

<p>URL에는 영문자, 숫자, 몇몇 기호들만 사용할 수 있다. 아스키 코드가 아닌 문자들을 퍼센트 인코딩 형식으로 바꾸어야 한다.</p>

<p>http.server 모듈로 간단한 웹 서버를 만들 수 있다.</p>

<p>코드 11-78</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">http.server</span>


<span class="k">class</span> <span class="nc">HTTPRequestHandler</span><span class="p">(</span><span class="n">http</span><span class="p">.</span><span class="n">server</span><span class="p">.</span><span class="n">BaseHTTPRequestHandler</span><span class="p">):</span>

   <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="s">"""HTTP GET 요청을 처리한다."""</span>
       <span class="bp">self</span><span class="p">.</span><span class="n">route</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">route</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="s">"""요청 URL의 path에 따라 요청을 처리할 함수를 중계한다."""</span>
       <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">path</span> <span class="o">==</span> <span class="s">'/hello'</span><span class="p">:</span>
           <span class="bp">self</span><span class="p">.</span><span class="n">hello</span><span class="p">()</span>
       <span class="k">else</span><span class="p">:</span>
           <span class="bp">self</span><span class="p">.</span><span class="n">response_404_not_found</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="s">"""200 OK 상태 코드와 인사말을 응답한다."""</span>
       <span class="bp">self</span><span class="p">.</span><span class="n">response</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s">'안녕하세요?'</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status_code</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
       <span class="s">"""응답 메시지를 전송한다."""</span>
       <span class="bp">self</span><span class="p">.</span><span class="n">send_response</span><span class="p">(</span><span class="n">status_code</span><span class="p">)</span>

       <span class="bp">self</span><span class="p">.</span><span class="n">send_header</span><span class="p">(</span><span class="s">'Content-type'</span><span class="p">,</span> <span class="s">'text/plain; charset=utf-8'</span><span class="p">)</span>
       <span class="bp">self</span><span class="p">.</span><span class="n">end_headers</span><span class="p">()</span>

       <span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">body</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>


<span class="n">ADDRESS</span> <span class="o">=</span> <span class="s">'localhost'</span><span class="p">,</span> <span class="mi">8000</span>

<span class="n">listener</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="n">server</span><span class="p">.</span><span class="n">HTTPServer</span><span class="p">(</span><span class="n">ADDRESS</span><span class="p">,</span> <span class="n">HTTPRequestHandler</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'http://</span><span class="si">{</span><span class="n">ADDRESS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s">:</span><span class="si">{</span><span class="n">ADDRESS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s"> 주소에서 요청 대기중...'</span><span class="p">)</span>
<span class="n">listener</span><span class="p">.</span><span class="n">serve_forever</span><span class="p">()</span>
</code></pre></div></div>

</div>



<div class="pagination">
  
  <a href="/2022-08-08/yeono-python-16" class="left arrow"
    >&#8592;</a
  >
   
  <a href="/2022-08-06/yeono-python-14" class="right arrow"
    >&#8594;</a
  >
  

  <a href="#" class="top">Top</a>
</div>
</main>

    <footer>
  <span>
    &copy; <time datetime="2023-08-05 14:34:20 +0900">2023</time> Sunmi Moon. Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
  </span>
</footer>

  </body>
</html>
